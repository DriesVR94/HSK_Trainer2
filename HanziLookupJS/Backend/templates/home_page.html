<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Let's Practice!</title>
  <link href="https://fonts.googleapis.com/css2?family=Titillium+Web:wght@200;400;600;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='home_page.css') }}">
</head>
<body>
    <header>
        <nav>
            <div>
                <img src="{{ url_for('static', filename='images/LogoHSKHero2.png') }}" alt="HSK Hero Logo" class="logo">
                
            </div>
            <div>
                <img src="" alt="Profile">
            </div>
        </nav>
    </header>
    <main>
        <section>
            <p>You haven't started any levels yet.</p>
            <div class="HSK2_0">
                <ol>
                    <li>Level 1</li>
                    <li>Level 2</li>
                    <li>Level 3</li>
                    <li>Level 4</li>
                    <li>Level 5</li>
                    <li>Level 6</li>
                </ol>
            </div>
            <div class="HSK3_0">
                <ol>
                    <li>Level 1</li>
                    <li>Level 2</li>
                    <li>Level 3</li>
                    <li>Level 4</li>
                    <li>Level 5</li>
                    <li>Level 6</li>
                    <li>Levels 7 - 9</li>
                </ol>
            </div>
            <button id="levelBtn">Add New Level</button>
            <div id="levelSelectionBtn" class="levelSelectionBtn">
                <div class="modal-content">
                    <span class="close">&times;</span>
                    <h2>HSK 2.0 (Current version)</h2>
                    <form id="levelForm">
                    <label><input type="checkbox" name="level" value="current Level 1"> Level 1</label><br>
                    <label><input type="checkbox" name="level" value="current Level 2"> Level 2</label><br>
                    <label><input type="checkbox" name="level" value="current Level 3"> Level 3</label><br>
                    <label><input type="checkbox" name="level" value="current Level 4"> Level 4</label><br>
                    <label><input type="checkbox" name="level" value="currentLevel 5"> Level 5</label><br>
                    <label><input type="checkbox" name="level" value="current Level 6"> Level 6</label><br>
                    <!-- Add more as needed --> 
                    <h2>HSK 3.0 (New version)</h2>
                    <form id="levelForm">
                    <label><input type="checkbox" name="level" value="new Level 1"> Level 1</label><br>
                    <label><input type="checkbox" name="level" value="new Level 2"> Level 2</label><br>
                    <label><input type="checkbox" name="level" value="new Level 3"> Level 3</label><br>
                    <label><input type="checkbox" name="level" value="new Level 4"> Level 4</label><br>
                    <label><input type="checkbox" name="level" value="new Level 5"> Level 5</label><br>
                    <label><input type="checkbox" name="level" value="new Level 6"> Level 6</label><br>
                    <label><input type="checkbox" name="level" value="new Level 7-9"> Level 7 - 9</label><br>
                    <br>
                    <button type="submit">Confirm</button>
                    </form>
                </div>
            </div>
        </section>
    </main>
    <script>
        const levelSelectionBtn = document.getElementById("levelSelectionBtn");
        const openBtn = document.getElementById("levelBtn");
        const closeBtn = document.querySelector(".levelSelectionBtn .close");

        // Open modal
        openBtn.onclick = () => {
            levelSelectionBtn.style.display = "block";
        }

        // Close modal
        closeBtn.onclick = () => {
            levelSelectionBtn.style.display = "none";
        }

        // Close modal when clicking outside of modal content
        window.onclick = (event) => {
            if (event.target == levelSelectionBtn) {
            levelSelectionBtn.style.display = "none";
            }
        }

        // Optional: Handle form submission
        const form = document.getElementById("levelForm");
        form.onsubmit = function(e) {
            e.preventDefault(); // Prevent actual form submission

            const levels = Array.from(form.elements['level'])
            .filter(input => input.checked)
            .map(input => input.value);

            alert("Selected levels: " + levels.join(", "));
            levelSelectionBtn.style.display = "none";
        }

        document.addEventListener("DOMContentLoaded", () => {
            const hsk2ListItems = document.querySelectorAll(".HSK2_0 li");
            const hsk3ListItems = document.querySelectorAll(".HSK3_0 li");
            const checkboxes = document.querySelectorAll("#levelSelectionBtn input[type='checkbox']");
            const message = document.querySelector("section > p"); // Select the message

            // Function to update the visibility of the message
            function updateMessageVisibility() {
                const anySelected = Array.from(checkboxes).some(cb => cb.checked);
                message.style.display = anySelected ? "none" : "block";
            }

            // Load saved selections from localStorage
            const savedSelections = JSON.parse(localStorage.getItem("levelSelections")) || {};

            // Apply saved selections on page load
            checkboxes.forEach((checkbox, index) => {
                const isHSK2 = index < 6; 
                const listItems = isHSK2 ? hsk2ListItems : hsk3ListItems;
                const listIndex = isHSK2 ? index : index - 6;

                if (savedSelections[checkbox.value]) {
                    checkbox.checked = true;
                    listItems[listIndex].style.display = "list-item";
                } else {
                    listItems[listIndex].style.display = "none";
                }
            });

            updateMessageVisibility(); // Check at page load

            // Listen for checkbox changes
            checkboxes.forEach((checkbox, index) => {
                checkbox.addEventListener("change", () => {
                    const isHSK2 = index < 6;
                    const listItems = isHSK2 ? hsk2ListItems : hsk3ListItems;
                    const listIndex = isHSK2 ? index : index - 6;

                    if (checkbox.checked) {
                        listItems[listIndex].style.display = "list-item";
                        savedSelections[checkbox.value] = true;
                    } else {
                        listItems[listIndex].style.display = "none";
                        delete savedSelections[checkbox.value];
                    }

                    // Save updated selections
                    localStorage.setItem("levelSelections", JSON.stringify(savedSelections));

                    updateMessageVisibility(); // Update after any change
                });
            });
        });
        </script>
</body>
</html>